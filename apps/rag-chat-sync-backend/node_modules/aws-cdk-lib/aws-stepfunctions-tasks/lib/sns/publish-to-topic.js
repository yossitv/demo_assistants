"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PublishToTopic=void 0;const JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti");var iam=()=>{var tmp=require("../../../aws-iam");return iam=()=>tmp,tmp},sfn=()=>{var tmp=require("../../../aws-stepfunctions");return sfn=()=>tmp,tmp},core_1=()=>{var tmp=require("../../../core");return core_1=()=>tmp,tmp},resource_arn_suffix_1=()=>{var tmp=require("../resource-arn-suffix");return resource_arn_suffix_1=()=>tmp,tmp};class PublishToTopic{topic;props;static[JSII_RTTI_SYMBOL_1]={fqn:"aws-cdk-lib.aws_stepfunctions_tasks.PublishToTopic",version:"2.230.0"};integrationPattern;constructor(topic,props){if(this.topic=topic,this.props=props,this.integrationPattern=props.integrationPattern||sfn().ServiceIntegrationPattern.FIRE_AND_FORGET,![sfn().ServiceIntegrationPattern.FIRE_AND_FORGET,sfn().ServiceIntegrationPattern.WAIT_FOR_TASK_TOKEN].includes(this.integrationPattern))throw new(core_1()).ValidationError(`Invalid Service Integration Pattern: ${this.integrationPattern} is not supported to call SNS.`,topic);if(this.integrationPattern===sfn().ServiceIntegrationPattern.WAIT_FOR_TASK_TOKEN&&!sfn().FieldUtils.containsTaskToken(props.message))throw new(core_1()).ValidationError("Task Token is missing in message (pass JsonPath.taskToken somewhere in message)",topic)}bind(_task){return{resourceArn:(0,resource_arn_suffix_1().getResourceArn)("sns","publish",this.integrationPattern),policyStatements:[new(iam()).PolicyStatement({actions:["sns:Publish"],resources:[this.topic.topicArn]})],parameters:{TopicArn:this.topic.topicArn,Message:this.props.message.value,MessageStructure:this.props.messagePerSubscriptionType?"json":void 0,Subject:this.props.subject}}}}exports.PublishToTopic=PublishToTopic;
